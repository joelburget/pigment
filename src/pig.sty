%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%                                                         %%%%%%%%%%
%%%%%%%%%%     Epigram LaTeX Style                                 %%%%%%%%%%
%%%%%%%%%%                                                         %%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%% DISCLAIMER:
%%
%% This file has been inherited from Pig the First, maybe
%% before. Therefore, it is not accurate wrt. Epigram Forever
%% syntax. It is a work in progress to clean this thing (many
%% duplicate) and update the syntax.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Colours                                                               %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{color}
\newcommand{\redFG}[1]{\textcolor[rgb]{0.6,0,0}{#1}}
\newcommand{\greenFG}[1]{\textcolor[rgb]{0,0.4,0}{#1}}
\newcommand{\blueFG}[1]{\textcolor[rgb]{0,0,0.8}{#1}}
\newcommand{\orangeFG}[1]{\textcolor[rgb]{0.8,0.4,0}{#1}}
\newcommand{\purpleFG}[1]{\textcolor[rgb]{0.4,0,0.4}{#1}}
\newcommand{\yellowFG}[1]{\textcolor{yellow}{#1}}
\newcommand{\brownFG}[1]{\textcolor[rgb]{0.5,0.2,0.2}{#1}}
\newcommand{\blackFG}[1]{\textcolor[rgb]{0,0,0}{#1}}
\newcommand{\whiteFG}[1]{\textcolor[rgb]{1,1,1}{#1}}
\newcommand{\yellowBG}[1]{\colorbox[rgb]{1,1,0.2}{#1}}
\newcommand{\brownBG}[1]{\colorbox[rgb]{1.0,0.7,0.4}{#1}}

\newcommand{\ColourEpigram}{
  \newcommand{\red}{\redFG}
  \newcommand{\green}{\greenFG}
  \newcommand{\blue}{\blueFG}
  \newcommand{\orange}{\orangeFG}
  \newcommand{\purple}{\purpleFG}
  \newcommand{\yellow}{\yellowFG}
  \newcommand{\brown}{\brownFG}
  \newcommand{\black}{\blackFG}
  \newcommand{\white}{\whiteFG}
}

\newcommand{\MonochromeEpigram}{
  \newcommand{\red}{\blackFG}
  \newcommand{\green}{\blackFG}
  \newcommand{\blue}{\blackFG}
  \newcommand{\orange}{\blackFG}
  \newcommand{\purple}{\blackFG}
  \newcommand{\yellow}{\blackFG}
  \newcommand{\brown}{\blackFG}
  \newcommand{\black}{\blackFG}
  \newcommand{\white}{\blackFG}
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Emphasis                                                              %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%% It's good to separate definitional emphasis...

\newcommand{\demph}{\textbf}

%%% ...from rhetorical emphasis.

\newcommand{\remph}{\textit}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Identifier Fonts                                                      %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\CN}{\textsf}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Expressions                                                           %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{upgreek}

\newcommand{\LAMBINDER}{\red{\uplambda}}
\newcommand{\Bhab}[2]{#1\!:\!#2}
\newcommand{\To}{\mathop{\blue{\rightarrow}}}
\newcommand{\Prod}{\mathop{\blue{\times}}}
\newcommand{\mto}{\mathop{\red{\mapsto}}}

\newcommand{\exprIn}{\CN{exprIn}}
\newcommand{\exprEx}{\CN{exprEx}}
\newcommand{\push}[2]{#2 \ni #1}
\newcommand{\pull}[2]{#1 \in #2}
\newcommand{\propag}[2]{#1 \:\triangleright\: #2}

\newcommand{\PiTy}[2]{\blue{\Pi}\: #1\: #2}
\newcommand{\PITEL}[2]{\blue{(}\Bhab{#1}{#2}\blue{)}}
\newcommand{\PI}[2]{\PITEL{#1}{#2}\To}
\newcommand{\PIS}[1]{\blue{(}#1\blue{)}\To}

\newcommand{\IPITEL}[2]{\blue{\{}\Bhab{#1}{#2}\blue{\}}}
\newcommand{\IPI}[2]{\IPITEL{#1}{#2}\To}
\newcommand{\IPIS}[1]{\blue{\{}#1\blue{\}}\To}

\newcommand{\LLAM}[2]{\LAMBINDER\Bhab{#1}{#2}.\,}
\newcommand{\LAM}[1]{\LAMBINDER #1 .\,}
\newcommand{\PLAM}[2]{\LAMBINDER_{#2} #1 .\,}

\newcommand{\TYPE}{\blue{\star}}
\newcommand{\EQ}{\mathrel{\D{=}}}


\newcommand{\FROG}{\mbox{\(\backslash\!\!\!\mid\!\!\!\slash\)}}

\newcommand{\ang}[1]{\red{\left<\black{#1}\right>}}
\newcommand{\sqr}[1]{\red{\left[\black{#1}\right]}}
\newcommand{\rbar}{\red{|}}

\DeclareMathAlphabet{\mathkw}{OT1}{cmss}{bx}{n}
\newcommand{\K}[1]{\mathkw{#1}}
\newcommand{\M}[1]{\mathit{#1}}
\newcommand{\V}[1]{\purple{\mathit{#1}}}
\newcommand{\p}{\purple{'}}
\newcommand{\D}[1]{\blue{\CN{#1}}}
\newcommand{\bquote}{\textrm{\textquoteright}}
\newcommand{\etag}[1]{\red{\bquote #1}}
\newcommand{\C}[1]{\red{\CN{#1}}}
\newcommand{\F}[1]{\green{\CN{#1}}}
\newcommand{\U}[1]{\orange{\CN{#1}}}

\newcommand{\Enum}{\D{Enum}}
\newcommand{\enum}[1]{\D{enum}\:#1}

\newcommand{\Sig}{\D{Sig}}
\newcommand{\dom}[1]{\F{dom}\:#1}
\newcommand{\sig}[1]{\D{sig}\:#1}
\newcommand{\Refl}{\overline}

\newcommand{\Rhab}{:}

\newcommand{\Ret}[1]{\:\FATR\:#1}
\newcommand{\By}[1]{\:\FATL\:#1}
\newcommand{\Refute}[1]{\:\FROG\:#1}
\newcommand{\With}[1]{\:\&\:#1}

\newcommand{\refl}[1]{\purple{\overline{\black{#1}}}}
\newcommand{\coe}[4]{#4\:\green{\left[\black{#3:#1\EQ#2}\right>}}
\newcommand{\coh}[4]%
  {#4\:\green{\left[\!\left[\black{#3:#1\EQ#2}\right|\!\right>}}

\newcommand{\qcoe}[3]{#1\:\green{\F{coe}(\black{#2\EQ #3})}}
\newcommand{\qcoh}[3]{#1\:\green{\F{coh}(\black{#2\EQ #3})}}
\newcommand{\qcong}[3]{#1\:\green{\F{cong}(\black{#2:#3})}}

\newcommand{\naughtE}[1]{#1\:\green{\FROG}}
\newcommand{\caseE}[1]{#1\:\F{case}}
\newcommand{\ExpandE}[1]{#1\:\F{Expand}}
\newcommand{\DecodeE}[1]{#1\:\F{Decode}}
\newcommand{\KitE}[2]{#1\:\F{Kit(}#2\F{)}}
\newcommand{\hd}{\green{\bullet}}
\newcommand{\tl}{\green{-}}
\newcommand{\rZ}{\red{\mathsf{0}}}
\newcommand{\rS}{\red{\mathsf{S}}}

%% Context
\newcommand{\Valid}{\textsc{valid}}

%% Set
\newcommand{\Set}{\blue{\textsc{Set}}}
\newcommand{\Type}[1]{{#1}:\Set}

%% Sigma
\newcommand{\SigmaTy}[2]{\blue{\Sigma}\: #1\: #2}
\newcommand{\SIGMA}[2]{\blue{(}\Bhab{#1}{#2}\blue{)}\Prod}
\newcommand{\SIGMAS}[1]{\blue{(}#1\blue{)}\Prod}
\newcommand{\TIMES}[1]{#1 \Prod}
\newcommand{\pair}[3]{\red{\left[\black{#1},\black{#2}\right]_{\black{#3}}}}
\newcommand{\fst}[1]{\pi_0\: #1}
\newcommand{\snd}[1]{\pi_1\: #1}

%% Prop
\newcommand{\Prop}{\blue{\textsc{Prop}}}
\newcommand{\prf}[1]{{:\!\!-}~#1}
\newcommand{\Trivial}{\CN{TT}}
\newcommand{\Absurd}{\CN{FF}}
\newcommand{\PropEq}{\mathrel{\D{==}}}
\newcommand{\Imply}{\mathop{\blue{\Rightarrow}}}
\newcommand{\ALL}[2]{\PITEL{#1}{#2}\Imply}

%% UId
\newcommand{\UId}{\D{UId}}
\newcommand{\Tag}[1]{\red{\CN{Tag}}~#1}

%% Enum
\newcommand{\EnumU}{\D{EnumU}}
\newcommand{\NilE}{\C{nilE}}
\newcommand{\ConsE}[2]{\C{consE}~#1~#2}

\newcommand{\EnumT}[1]{\D{EnumT}~#1}
\newcommand{\Ze}{\C{$0$}}
\newcommand{\Su}[1]{\C{$1\!+$}~#1}

\newcommand{\spi}[2]{\F{$\pi$}~#1~#2}
\newcommand{\switch}[4]{\green{\CN{switch}}~#1~#2~#3~#4}
\newcommand{\spiD}[1]{\F{$\pi_D$}~#1}
\newcommand{\switchD}[3]{\green{\CN{switchD}}\green{(} #1 , #2 , #3 \green{)}}

\newcommand{\Unit}{\D{Unit}}
\newcommand{\Void}{\C{[]}}


%% Desc
\usepackage{stmaryrd}

\newcommand{\Desc}{\D{Desc}}
\newcommand{\DescD}{\C{DescD}}
\newcommand{\TagDesc}{\F{TagDesc}}

\newcommand{\descop}[2]{\green{\llbracket} #1 \green{\rrbracket}~#2}

\newcommand{\DUnit}{\etag{1}}
\newcommand{\DSigma}[2]{\etag{\Sigma}~#1~#2}
\newcommand{\DIndx}[1]{\etag{\CN{ind}\!\times}~#1}

\newcommand{\DHindx}[2]{\etag{\CN{hind}\!\times}~#1~#2}

\newcommand{\DPi}[2]{\etag{\Pi}~#1~#2}
\newcommand{\DProd}[2]{#1 \mathop{\etag{\!\times}} #2}
\newcommand{\DId}{\etag{\CN{id}}}

%% Mu
\newcommand{\Mu}[1]{\D{Mu}~#1}
\newcommand{\Con}[1]{\C{con}~#1}
\newcommand{\All}[4]{\F{All}~#1~#2~#3~#4}


%% IDesc
\newcommand{\IDesc}[1]{\D{IDesc}~#1}
\newcommand{\IDescD}{\C{IDescD}}
\newcommand{\IDescFreeD}{\C{IDescD}_{\C{Free}}}
\newcommand{\TagIDesc}[1]{\F{TagIDesc}~#1}

\newcommand{\idescop}[3]{\green{\llbracket} #1 \green{\rrbracket}_{#2}~#3}

\newcommand{\DVar}[1]{\etag{\CN{var}}~#1}
\newcommand{\DConst}[1]{\etag{\CN{const}}~#1}
\newcommand{\DPrf}[1]{\etag{\prf{}}~#1}

%% IMu
\newcommand{\IMu}[3]{\D{IMu}_{#1}~#2~#3}


%% Agda-style data-type declaration
\newcommand{\data}{\mathkw{data}\;}
\newcommand{\where}{\;\mathkw{where}}

%% Free monad
\newcommand{\FreeMonad}[2]{{#1}^{\F{\(\ast\)}}~#2}
\newcommand{\FreeIMonad}[3]{{#1}^{\F{\(\ast\)}}_{#2}~#3}


%% Nat
\newcommand{\Nat}{\D{Nat}}
\newcommand{\NatD}{\C{NatD}}
\newcommand{\NatZero}{\etag{\CN{zero}}}
\newcommand{\NatSuc}[1]{\etag{\CN{suc}}~#1}

%% List
\newcommand{\List}{\D{List}}
\newcommand{\ListD}{\C{ListD}}
\newcommand{\ListNil}{\etag{\CN{nil}}}
\newcommand{\ListCons}[2]{\etag{\CN{cons}}~#1~#2}

%% Tree
\newcommand{\Tree}{\D{Tree}}
\newcommand{\TreeD}{\C{TreeD}}
\newcommand{\TreeLeaf}{\etag{\CN{leaf}}}
\newcommand{\TreeNode}{\etag{\CN{node}}}

%% Lambda terms
\newcommand{\LambdaT}{\D{LambdaT}}
\newcommand{\LambdaTD}{\C{LambdaTD}}
\newcommand{\LambdaTFreeD}{\LambdaTD_{\C{Free}}}
\newcommand{\LambdaTVar}{\etag{\CN{v}}}
\newcommand{\LambdaTApp}{\etag{\CN{app}}}
\newcommand{\LambdaTLam}{\etag{\CN{lam}}}

%% Fin
\newcommand{\Fin}[1]{\D{Fin}\:#1}
\newcommand{\FinD}{\C{FinD}}
\newcommand{\FinZero}{\etag{\CN{Fz}}}
\newcommand{\FinSuc}[1]{\etag{\CN{Fs}}\:#1}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Grammars                                                              %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\SC}{\textsc}  %% syntactic category
\newcommand{\Grammar}[2]{
  \begin{array}[t]{rrll}
    #1 & ::= & #2
  \end{array}
}
\newcommand{\Gor}{\\ & | &}  %% separator making new row of array
\newcommand{\GNew}[1]{\medskip \\ #1 & ::= &}
\newcommand{\Gbr}[2]{\!\left\lgroup #2 \right\rgroup^{\!\!#1}}

\newcommand{\wbox}{\square}
\newcommand{\bbox}{\blacksquare}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Judgments                                                             %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\EC}{\mathcal{E}}
\newcommand{\Tn}{\vdash}
\newcommand{\Eq}{\equiv}
\newcommand{\x}{\V{x}}
\newcommand{\xS}{\Bhab{\x}{S}}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Computation Relations                                                 %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{amssymb}
\newcommand{\step}[1]{\leadsto_{#1}}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Meta-Computation Relations                                            %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\mq}{\mathrel{\Longrightarrow}}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Nonexamples                                                           %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%% Non-examples in display math must be explicitly marked as such, in order
%%% to avoid dangerous wrong learnings.

\newcommand{\BAD}{\mbox{\(\red{(\times)}\)}}
\newcommand{\NONEXAMPLE}[1]{
\[
\BAD\qquad
#1
\]%
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Source                                                                %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newenvironment{source}{\[\begin{array}[t]{ll}}{\end{array}\]}

\newcommand{\letH}[2]{\K{let} & #1 \quad #2}
\newcommand{\letV}[2]{\K{let} & #1 \\ #2}

\newcommand{\sgap}{\medskip \\}
\newcommand{\X}{l@{\:}}
\newcommand{\I}{@{\!\_}l@{}}
\newcommand{\prog}[2]{\begin{array}[t]{@{}#1}#2\end{array}}
\newcommand{\dent}[2]{\multicolumn{#1}{@{\;\;}l}{#2}}
\newcommand{\UPI}[1]{\PIBINDER{#1}\FATR}
\newcommand{\ULAM}[1]{\LAMBINDER{#1}\FATR}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Vertical Arrangement                                                  %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\STL}[1]{\begin{array}[t]{@{}l@{}}#1\end{array}}
\newcommand{\STC}[1]{\begin{array}[t]{@{}c@{}}#1\end{array}}
\newcommand{\CASES}[1]{\begin{array}[t]{@{}l@{\;\mapsto\;}l@{}}#1\end{array}}

\newcommand{\stk}[1]{\begin{array}[t]{@{}l@{}}#1\end{array}}
\newcommand{\stkl}[1]{\begin{array}[b]{@{}l@{}}#1\end{array}}
\newcommand{\stkc}[1]{\begin{array}[b]{@{}c@{}}#1\end{array}}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Ecce                                                                  %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\ecce}[1]{\begin{array}{@{}l@{\;}l}#1\end{array}}

\newcommand{\ecDEFN}[4]{
\F{#1}&[\\
\multicolumn{2}{@{}l}{\quad\ecce{#2}}\\
\;]&\FATR\;#3\;:\:#4 \\
}
\newcommand{\ecDefn}[4]{
\F{#1} & [#2]\;\FATR\;#3\;:\:#4 \\
}
\newcommand{\ecdefn}[3]{
\F{#1} & \FATR\;#2\;:\:#3 \\
}
\newcommand{\ecHOLE}[3]{
\U{#1} & [\\
\multicolumn{2}{@{}l}{\quad\ecce{#2}}\\
\;]&\FATR\;?\;:\:#3\\
}
\newcommand{\ecHole}[3]{
\U{#1}&[#2]\;\FATR\;?\;:\:#3 \\
}
\newcommand{\echole}[2]{
\U{#1} & \FATR\;?\;:\:#2 \\
}
\newcommand{\ecpara}[2]{
\V{#1} & :\;#2 \\
}

